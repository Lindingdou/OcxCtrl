# 学习笔记

## 1 引言

ActiveX是Microsoft对于一系列策略性面向对象程序技术和工具的称呼，其中主要的技术是组件对象模型（COM）。 ActiveX控件是一种实现了一系列特定接口而使其在使用和外观上更象一个控件的COM组件。ActiveX控件这种技术涉及到了几乎所有的COM和OLE的技术精华，如可链接对象、统一数据传输、OLE文档、属性页、永久存储以及OLE自动化等。

- ActiveX控件作为基本的界面单元，必须拥有自己的属性和方法以适合不同特点的程序和向包容器程序提供功能服务，其属性和方法均由自动化服务的 IDispatch接口来支持。
- 除了属性和方法外，ActiveX控件还具有区别于自动化服务的一种特性--事件。事件指的是从控件发送给其包容程序的一 种通知。
- 与窗口控件通过发送消息通知其拥有者类似，**ActiveX 控件**是通过触发事件来通知其包容器的。
- 事件的触发通常是通过控件包容器提供的**IDispatch接口**来调用自动化对象的方法来实现的。
- ActiveX控件的方法、属性和事件均有自定义（**custom**）和库存（**stock**）两种不同的类型：
  - 自定义（**custom**）的方法和属性也就是是普通的自动化方法和属性，自定义事件则是自己选取名字和Dispatch ID的事件。
  - 库存（**stock**）的方法、属性和事件则是使用了ActiveX控件规定了名字和Dispatch ID的"标准"方法、属性和事件。

## 2 MFC ActiveX项目向导配置

MFC ActiveX控件向导参数配置说明：

![](https://github.com/Lindingdou/OcxCtrl/blob/master/image/classview.jpg?raw=true)

- CoxControlApp 是控件的主程序模 块 ， 定义了控件的注 册（ DllRegisterServer）、删除（DllUnregisterServer）等功能，一般不用动，如有需要可以在其中的 InitInstance 和ExitInstance 中定义我们自己的初始化和终止操作代码，一般也就是一些资源的初始化和销毁工作。
- CoxControlCtrl是控件类，要做的控件功能基本上就是要在这个类中实现。需要提一下的是在这个类中重写了父类的 OnDraw 函数。实际控件开发中可以根据功能需要修改重写这个函数来绘制控件界面。
- CoxControlPage 是属性页类，这个类实现了一个在开发时设定控件属性的对话框。
- CoxControlLib 是为客户程序提供本控件的属性、方法以及可能响应的事件的接口的。

## 3 属性、方法和事件

属性：属性是AcitveX控件想所有容器公开的数据成员。

方法：方法就是控件开放给用户使用的一些功能函数，类似于C++的类函数。开发人员可以提供自定义功能。

事件：ActiveX通过事件通知容器控件上发生了某些事情。将控件开发人员的某一特定操作识别为事件。